## pnpm
`pnpm -r（recursive）`会在 workspace 声明的所有包里找脚本
也就是 pnpm-workspace.yaml 里匹配到的：apps/*、packages/*

它不是“随便找子目录”，而是找被 workspace 收录的包

只有该包的 package.json 里存在对应 script（比如 dev），才会执行

## 环境配置

- 避免硬编码：端口、域名、代理、容器网络、线上网关都会变

- 环境隔离：dev/staging/prod 的 API 地址不同，用 env 切换最干净

- 更可测试：本地可以轻松切到 mock / staging

- Vite 里 import.meta.env 会把 VITE_ 前缀变量注入前端（构建时注入）

## Nestjs 同源处理

- CORS 是浏览器为了安全限制跨域请求

- 后端通过返回特定响应头（如 Access-Control-Allow-Origin）告诉浏览器“允许”

- enableCors 本质就是让 Nest 自动加这些响应头

- 真正上线一般不会到处开 *，会限制 origin，并注意是否需要 credentials

```ts

app.enableCors({ origin: 'http://localhost:5173', credentials: true })

// 允许多个来源
app.enableCors({
  origin: ['http://localhost:5173', 'http://localhost:5174'],
  credentials: true,
})

// 动态判断
app.enableCors({
  origin: (origin, callback) => {
    // origin 可能是 undefined（例如 curl/postman 或同源请求）
    if (!origin) return callback(null, true)

    const allowList = new Set([
      'http://localhost:5173',
      'http://localhost:5174',
    ])

    if (allowList.has(origin)) return callback(null, true)

    return callback(new Error(`CORS blocked for origin: ${origin}`), false)
  },
  credentials: true,
})
```